# Хранилище - система контроля доступа

Django приложение для отслеживания посещений хранилища сотрудниками компании.

## Функциональность

1. **Список активных пропусков** - отображает всех сотрудников с активными пропусками
2. **Люди в хранилище** - показывает кто сейчас находится в хранилище и как долго
3. **История визитов сотрудника** - отображает все визиты конкретного сотрудника
4. **Выявление подозрительных визитов** - отмечает визиты дольше 1 часа как подозрительные

## Установка и запуск

```bash
git clone <https://github.com/Suba79/django-orm-watching-storage-part-2>
```

## Установка зависимостей
```bash 
pip install -r requirements.txt
```

## Настройка окружения

Создайте файл .env в корне проекта:

```env
DEBUG=True
```

## Запуск сервера
```bash
python manage.py runserver 0.0.0.0:8080
```
### Настройка подключения к базе данных

Для подключения к PostgreSQL используются следующие переменные. У всех них уже заданы рабочие значения по умолчанию для учебной базы данных, поэтому для начала работы их можно не переопределять.

| Переменная | Описание | Значение по умолчанию |
|------------|----------|----------------------|
| `DB_HOST` | Хост БД | (не задано) |
| `DB_PORT` | Порт БД | (не задано) |
| `DB_NAME` | Имя БД | (не задано) |
| `DB_USER` | Пользователь | (не задано) |
| `DB_PASSWORD` | Пароль | (не задано) |

#### `DEBUG` (обязательная)
- **Описание:** Режим отладки Django
- **Значения:** `True` или `False`
- **По умолчанию:** `True`
- **Влияние на программу:**
  - При `DEBUG=True`:
    - Показываются подробные страницы ошибок
    - Включена отладочная информация
    - Статические файлы обслуживаются Django
  - При `DEBUG=False`:
    - Показываются стандартные страницы ошибок
    - Отключена отладочная информация
    - Для продакшн-среды

#### `SECRET_KEY` (опциональная)

- Описание: Секретный ключ Django для криптографических операций. **Без этой переменной проект не запустится.**
- Пример: `django-insecure-ваш-уникальный-секретный-ключ-здесь`
- Важно: Никогда не используйте значение по умолчанию 'REPLACE_ME' на реальном сервере. Генерируйте уникальный ключ для каждого окружения.

#### `ALLOWED_HOSTS` (важно для безопасности!)

- При `DEBUG=True`: можно оставить пустым для локальной разработки
- При `DEBUG=False`: обязательно задайте домены вашего сайта
- Пример: `ALLOWED_HOSTS=example.com,www.example.com`

### Пример файла `.env`

```
# Режим разработки
DEBUG=True
# Секретный ключ (для продакшена)
# SECRET_KEY=ваш-секретный-ключ-тут
# Настройки БД (если нужно переопределить)
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=my_database
# DB_USER=my_user
# DB_PASSWORD=my_password
```
## Создание файла .env

1. В корне проекта создайте файл .env

2. Добавьте необходимые переменные (см. пример выше)

3. Убедитесь, что файл добавлен в .gitignore

### Описание переменных:

* DEBUG - включает/выключает режим отладки Django

    * True - показываются подробные страницы ошибок

    * False - показываются стандартные страницы ошибок (для продакшена)

* SECRET_KEY - секретный ключ для безопасности приложения (обязателен в продакшене)

## Запустить сервер на порту 8080

python manage.py runserver 0.0.0.0:8080

## Ожидаемый вывод в консоль:

``` text 
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
December 06, 2025 - 12:00:00
Django version 5.2.4, using settings 'project.settings'
Starting development server at http://0.0.0.0:8080/
Quit the server with CTRL-BREAK.
```
## Проверка доступных команд Django

```bash 
# Показать все доступные команды
python manage.py help
```

## Пример вывода:
```text 
Type 'manage.py help <subcommand>' for help on a specific subcommand.

Available subcommands:

[django]
    check
    compilemessages
    createcachetable
    dbshell
    diffsettings
    dumpdata
    flush
    inspectdb
    loaddata
    makemessages
    makemigrations
    migrate
    runserver
    shell
    showmigrations
    startapp
    startproject
    test
    testserver
```

## Откройте в браузере

* Главная страница: http://127.0.0.1:8080/
* Люди в хранилище: http://127.0.0.1:8080/storage_information

### Главная страница

* Показывает список всех сотрудников с активными пропусками

* Для просмотра истории визитов сотрудника - кликните на его имя

### Страница "Люди в хранилище"

* Показывает сотрудников, которые сейчас находятся в хранилище

* Отображает продолжительность их нахождения

* Отмечает подозрительные визиты (дольше 1 часа)

### Страница визитов сотрудника

* Показывает полную историю визитов сотрудника

* Для каждого визита отображает:

    * Дата и время входа

    * Продолжительность визита

    * Является ли визит подозрительным

## Технологии

* Python 3.12+

* Django 5.2

* PostgreSQL

* HTML/CSS (шаблоны Django)

## Структура проекта
```text 
django-orm-watching-storage-part-2-master/
├── datacenter/              # Основное приложение
│   ├── models.py           # Модели данных
│   ├── views.py            # Представления (контроллеры)
│   └── templates/          # HTML шаблоны
├── project/                # Настройки проекта
│   ├── settings.py         # Настройки Django
│   └── urls.py            # Маршруты URL
├── manage.py              # Утилита управления Django
├── .env                   # Переменные окружения
├── requirements.txt       # Зависимости Python
└── README.md              # Этот файл
```

## Особенности

* Использует Django ORM для работы с базой данных

* Автоматический расчет продолжительности визитов

* Определение подозрительных визитов (дольше 60 минут)

* Локализация на русский язык

* Адаптивная верстка


